# WordPiece

---

### WordPiece
WordPiece算法是一种用于对词汇进行分割和子词划分的算法，常用于自然语言处理任务中的词嵌入和文本处理。它是由Google开发并在BERT模型中使用的一种子词分割方法。

WordPiece算法的基本思想是将词汇表中的单词划分成更小的子词（subword），从而提高模型对未登录词（Out-of-Vocabulary，OOV）和罕见词的处理能力，并且可以更好地处理词汇的复杂性和形态变化。

WordPiece算法的主要步骤包括：

1. **初始化**：首先，将所有单词都初始化为单个字符或者字符序列。

2. **迭代划分**：然后，通过迭代地合并频率最高的相邻字符或字符序列来生成更大的子词。==**合并的依据通常是最大化一个模型评价指标**==，比如词汇表覆盖率或者最小化模型困惑度。迭代的次数可以根据需要来决定，通常是一些预定的固定值。

3. **停止条件**：当达到停止条件时（如迭代次数达到预设值或者词汇表大小达到上限），停止迭代并生成最终的子词词汇表。

WordPiece算法的一个优点是它可以自适应地学习词汇的复杂性和形态变化，同时保留了原始文本的一些语义信息。因此，WordPiece算法在自然语言处理任务中得到了广泛的应用，特别是在基于Transformer结构的模型中，如BERT、GPT等。

总的来说，WordPiece算法通过将单词划分成更小的子词，提高了模型对词汇的覆盖能力和泛化能力，从而改善了文本处理和语言建模的效果。




<br>
<br>



### WordPiece 与 BPE 关系
WordPiece和BPE（Byte Pair Encoding）都是一种常用的子词分割算法，用于将单词分割成更小的子词。它们在原理上有一些相似之处，但也有一些区别。

1. **相似之处**：

   - **基本原理**：WordPiece和BPE都是基于频率统计的贪婪算法，通过反复合并频率最高的相邻字符或字符序列来生成更大的子词，直到达到预定的停止条件。
   
   - **动态生成词汇表**：两者都可以根据数据集自适应地生成词汇表，无需人工提供先验知识，因此能够灵活适应不同的语料库和任务。

2. **区别之处**：

   - **合并策略**：WordPiece算法在合并相邻字符或字符序列时，**通常会考虑一个额外的模型评价指标（如词汇表覆盖率或困惑度）**，以优化合并的选择。而BPE算法通常只根据频率来选择合并的字符或字符序列。

   - **词汇表生成**：WordPiece算法会在每次迭代中都重新生成词汇表，而BPE算法通常会在预定的迭代次数或达到词汇表大小上限时停止。

   - **应用场景**：WordPiece算法更多地应用于自然语言处理领域，特别是在基于Transformer结构的模型中，如BERT、GPT等。而BPE算法在文本压缩和编码领域也有广泛应用，如数据压缩、编码和解码等。

总的来说，WordPiece和BPE都是一种有效的子词分割算法，它们都能够提高模型对未登录词和罕见词的处理能力，但在具体实现和应用上有一些区别。




<br>
<br>



### 词汇表覆盖率、困惑度 
词汇表覆盖率（Vocabulary Coverage）和困惑度（Perplexity）是两个与自然语言处理模型相关的重要指标。

1. **词汇表覆盖率**：
   - 词汇表覆盖率指的是**模型生成的子词词汇表中所包含的词汇数量占总词汇数量的比例**。在WordPiece或BPE算法中，模型根据某个评价指标（如词频、信息增益等）来选择合并字符或字符序列，其中之一可能是词汇表覆盖率。词汇表覆盖率越高，表示模型生成的子词词汇表能够覆盖更多的文本中的词汇，从而提高了模型的泛化能力和效果。

2. **困惑度**：
   - 困惑度是一种用于评估语言模型的指标，**表示模型对给定文本序列的预测困难程度**。在语言建模任务中，困惑度通常被定义为模型在给定的文本序列上的平均对数似然概率的负数。直观上，困惑度越低，表示模型对文本序列的预测越准确，也就是说，模型越不困惑。

在使用**词汇表覆盖率作为评价指标时**，我们希望模型生成的子词词汇表能够尽可能地覆盖训练数据中的词汇，从而保证模型在未知词汇或罕见词上有较好的性能。而在**使用困惑度作为评价指标时**，我们希望模型能够在给定的文本序列上尽可能地准确地预测下一个词汇，以提高模型的语言建模能力。